<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create and manipulate quosures easily — quosure • svFlow</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="152x152" href="../apple-touch-icon-152x152.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- svPkgdown --><script src="../script.js"></script><!-- themify icon --><link rel="stylesheet" href="../themify-icons.css?nocache=123"><!--<link rel="stylesheet" href="../style.css?nocache=123">--><!-- bootstrat v4.1.1, required CSS from more recent version --><link rel="stylesheet" href="../bootstrap.more.css?nocache=123"><link href="../style.css?nocache=123" rel="stylesheet"><!-- end of addition for svPkgdown --><meta property="og:title" content="Create and manipulate quosures easily — quosure"><meta property="og:description" content="Quosures are defined in rlang package as part of the tidy
evaluation of non-standard expressions (see quo()). Here, we provide an
alternate mechanism using -~expr as a synonym of quo(expr). Also,
+quo_obj is equivalent to !!quo_obj in rlang, and ++quo_obj both
unquotes and evaluates it in the right environment. Quosures are keystone
objects in the tidy evaluation mechanism. So, they deserve a special, clean
and concise syntax to create and manipulate them.
The as_xxx() and is_xxx() further ease the manipulation of quosures
or related objects."><meta property="og:image" content="https://www.sciviews.org/svFlow/logo.png"><meta name="twitter:card" content="summary"><!-- Mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js" async integrity="sha256-nlrDrBTHxJJlDDX22AS33xYI1OJHnGMDhiYMSe2U0e0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/config/TeX-AMS-MML_HTMLorMML.js" async integrity="sha256-4zys9A4hMQmtq2EUL+JRoXc0NZi8jVJMzb8onewOaSQ=" crossorigin="anonymous"></script><!-- Global site tag (gtag.js) - Google Analytics --><!--<script async src="https://www.googletagmanager.com/gtag/js?id=UA-462421-8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-462421-8');
</script>--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><!-- preloader start --><div class="preloader">
  <img src="../preloader.gif" alt="loading..."></div>
<!-- preloader end -->

<div class="navbar navbar-default navbar-fixed-top bg-secondary" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="navbar-brand-container">
       <div class="navbar-brand-logo">
         <a class="external-link navbar-brand" href="https://www.sciviews.org">
          <img src="../logo_full.png" alt="SciViews"></a>
       </div>
       <div class="navbar-brand-package">
      </div>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <!-- start svPkgdown global site search with Google -->
      <form action="https://www.google.com/search" class="navbar-form navbar-right search-form-global">
        <div class="form-group has-search">
          <span class="fa fa-search form-control-feedback-global"></span>
          <input type="text" class="form-control-global search-form-input" name="q" id="q" placeholder="Search..." required><input type="hidden" name="sitesearch" value="https://www.sciviews.org"></div>
      </form>
      <!-- end svPkgdown global site search with Google -->
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/svFlow_rationate.html">(Work)flow and alternate pipe operator, rationate</a>
    </li>
    <li>
      <a href="../articles/svFlow_tutorial.html">(Work)flow and alternate pipe operator, tutorial</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/SciViews/svFlow/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><div class="navbar-title">
        <a class="navbar-brand" href="../index.html"><p class="h2">svFlow <small>v1.2.1</small></p></a>
      </div>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
  <div class="navbar-spacer bg-light">
  </div>
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create and manipulate quosures easily</h1>
    <small class="dont-index">Source: <a href="https://github.com/SciViews/svFlow/blob/HEAD/R/quosure.R" class="external-link"><code>R/quosure.R</code></a></small>
    <div class="hidden name"><code>quosure.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Quosures are defined in rlang package as part of the tidy
evaluation of non-standard expressions (see <code><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">quo()</a></code>). Here, we provide an
alternate mechanism using <code>-~expr</code> as a synonym of <code>quo(expr)</code>. Also,
<code>+quo_obj</code> is equivalent to <code>!!quo_obj</code> in rlang, and ++quo_obj both
unquotes and evaluates it in the right environment. Quosures are keystone
objects in the tidy evaluation mechanism. So, they deserve a special, clean
and concise syntax to create and manipulate them.</p>
<p>The <code>as_xxx()</code> and <code>is_xxx()</code> further ease the manipulation of <strong>quosure</strong>s
or related objects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code># S3 method for formula
-(e1, e2)

# S3 method for formula
+(e1, e2)

# S3 method for quosure
^(e1, e2)

# S3 method for quosure
+(e1, e2)

# S3 method for unquoted
+(e1, e2)

# S3 method for unquoted
print(x, ...)

as.quosure(x, env = caller_env())

is.quosure(x)

is.formula(x)

is.bare_formula(x)

`!!`(x)</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>e1</dt>
<dd><p>Unary operator member, or first member of a binary operator.</p></dd>


<dt>e2</dt>
<dd><p>Second member of a binary operator (not used here, except for <code>^</code>).</p></dd>


<dt>x</dt>
<dd><p>An expression</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method (not used yet).</p></dd>


<dt>env</dt>
<dd><p>An environment specified for scoping of the quosure.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>These functions build or manipulated <strong>quosure</strong>s and return such
objects. <code>+quosure</code> creates an <strong>unquoted</strong> object. The <code>+</code> unary operator
applied to <strong>unquoted</strong> objects evaluate the expression contained in the
<strong>quosure</strong> in the right environment.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>-</code> is defined as an unary minus operator for <strong>formula</strong> objects
(which is <em>not</em> defined in base R, hence, not supposed to be used otherwise).
Thus, <code>-~expr</code> just converts a formula build using the base <code>~expr</code>
instruction into a <strong>quosure</strong>. <code>as.quosure()</code> does the same, when the
expression is provided directly, and allows also to define the enclosing
environment (by default, it is the environment where the code is evaluated,
and it is also the case when using <code>-~expr</code>).</p>
<p>Similarly, the unary <code>+</code> operator is defined for <strong>quosure</strong> in order to
easily "reverse" the mechanism of quoting an expression with a logical
complementary operator. It does something similar to <code>!!</code> in rlang, but
it can be used outside of tidy eval expressions. Since unary <code>+</code> has higher
syntax precedence than <code>!</code> in R, it is less susceptible to require
parentheses (only <code>^</code> for exponentiation, indexing/subsetting operators like
<code>$</code> or <code>[</code>, and namespace operators <code>::</code> and <code>:::</code> have higher precedence). A
specific <code>^</code> operator for quosures solves the precedence issue. <code>::</code> or <code>:::</code>
are very unlikely used in the context.</p>
<p><code>++quosure</code> is indeed a two-steps operation (<code>+(+quosure)</code>). It first
unquotes the quosure, returning an <strong>unquoted</strong> object. Then, the second <code>+</code>
evaluates the <strong>unquoted</strong> object. This allows for fine-graded manipulation
of <strong>quosure</strong>s: you can unquote at one place, and evaluate the <strong>unquoted</strong>
object elsewhere (and, of course, the contained expression is always
evaluated in the <em>right</em> environment, despite all these manipulations).</p>
<p><code>!!</code> and just evaluates its argument and passes the result. It is only useful
inside a quasi-quoted argument, see <code><a href="https://rlang.r-lib.org/reference/topic-inject.html" class="external-link">quasiquotation</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="quos_underscore.html">quos_underscore</a>, <code>%&gt;_%</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="co"># Create a quosure (same as quo(x))</span></span></span>
<span class="r-in"><span><span class="va">x_quo</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">~</span><span class="va">x</span></span></span>
<span class="r-in"><span><span class="va">x_quo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">&lt;quosure&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> expr: <span style="color: #0000BB;">^x</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> env:  <span style="color: #0000BB;">0x5625bd8cc228</span></span>
<span class="r-in"><span><span class="co"># Unquote it (same as !!x, but usable everywhere)</span></span></span>
<span class="r-in"><span><span class="op">+</span><span class="va">x_quo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (x) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5625bd8cc228&gt;</span>
<span class="r-in"><span><span class="co"># Unquote and evaluate the quosure</span></span></span>
<span class="r-in"><span><span class="op">+</span><span class="op">+</span><span class="va">x_quo</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval_tidy(e1):</span> object 'x' not found</span>
<span class="r-in"><span><span class="co"># Syntax precedence issues (^ has higher precedence than unary +)</span></span></span>
<span class="r-in"><span><span class="co"># is solved by redefining ^ for unquoted objects:</span></span></span>
<span class="r-in"><span><span class="op">+</span><span class="op">+</span><span class="va">x_quo</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]   1   4   9  16  25  36  49  64  81 100</span>
<span class="r-in"><span><span class="co"># acts like if ++ had higher precedence than ^, thus like if it was</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="op">+</span><span class="op">+</span><span class="va">x_quo</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval_tidy(e1):</span> object 'x' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assign the unquoted expression</span></span></span>
<span class="r-in"><span><span class="va">x_unquo</span> <span class="op">&lt;-</span> <span class="op">+</span><span class="va">x_quo</span></span></span>
<span class="r-in"><span><span class="co"># ... and use x_unquo in a different context</span></span></span>
<span class="r-in"><span><span class="va">foo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span><span class="va">x</span></span></span>
<span class="r-in"><span><span class="fu">foo</span><span class="op">(</span><span class="va">x_unquo</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval_tidy(e1):</span> object 'x' not found</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><!-- footer --><!--<footer class="bg-secondary">--><div class="bg-secondary full-width">
    <div class="py-100 border-bottom" style="border-color: #454547 !important">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-4">
                    <div class="mb-5 mb-md-0 text-center text-md-left">
                        <!-- logo -->
                        <img class="mb-30" src="https://www.sciviews.org/images/logo-footer.png" alt="logo"><p class="text-white mb-30"> We build software for reproducible research with R</p>
                        <!-- social icon -->
                        <ul class="list-inline"><li class="list-inline-item">
                                <a class="external-link social-icon-outline" href="https://github.com/SciViews">
                                    <i class="ti-github"></i>
                                </a>
                            </li>

                            <li class="list-inline-item">
                                <a class="external-link social-icon-outline" href="https://twitter.com/PhilGrosjean">
                                    <i class="ti-twitter-alt"></i>
                                </a>
                            </li>

                            <li class="list-inline-item">
                                <a class="external-link social-icon-outline" href="https://www.linkedin.com/in/philippe-grosjean-5b6b29a2/">
                                    <i class="ti-linkedin"></i>
                                </a>
                            </li>

                        </ul></div>
                </div>
                <!-- footer links -->
                <div class="col-lg-2 col-md-4 col-6">
                    <p class="h4 text-white mb-4">Related</p>
                    <ul class="footer-links"><li>
                            <a href="http://econum.umons.ac.be" class="external-link">Our Lab</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/fs/en/" class="external-link">Our Faculty</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/complexys/en/" class="external-link">Complexys</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/infortech/en/" class="external-link">InforTech</a>
                        </li>

                        <li>
                            <a href="https://web.umons.ac.be/en/" class="external-link">UMONS</a>
                        </li>

                    </ul></div>
                <!-- footer links -->
                <div class="col-lg-2 col-md-4 col-6">
                    <p class="h4 text-white mb-4">Quick Link</p>
                    <ul class="footer-links"><li>
                            <a href="https://www.sciviews.org/software/svbox" class="external-link">SciViews Box</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/software/sciviews-r" class="external-link">SciViews::R</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/software/zooimage" class="external-link">Zoo/PhytoImage</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/blog" class="external-link">Blog</a>
                        </li>

                        <li>
                            <a href="https://www.sciviews.org/about" class="external-link">About</a>
                        </li>

                    </ul></div>
                <!-- subscribe form -->
                <div class="col-lg-3 col-md-12 offset-lg-1">
                    <div class="mt-5 mt-lg-0 text-center text-md-left">
                             <p class="h4 mb-4 text-white">Contact Us</p>
                             <p class="text-white mb-4">Need more info?<br><a href="mailto:info@sciviews.org"><span class="text-primary">Leave us a mail...</span></a></p>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- copyright -->
    <div class="pt-4 pb-3 position-relative">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 col-md-5">
                    <p class="text-white text-center text-md-left">
                        <span class="text-primary">SciViews</span> © All Right Reserved</p>
                </div>
                <div class="col-lg-6 col-md-7">
                    <ul class="list-inline text-center text-md-right"><li class="list-inline-item mx-lg-3 my-lg-0 mx-2 my-2">
                            <a class="external-link font-secondary text-white" href="https://creativecommons.org/licenses/by/4.0/">Site content under CC-BY 4.0 license</a>
                        </li>

                    </ul></div>
            </div>
        </div>
        <!-- back to top -->
        <!--<button class="back-to-top">
            <i class="ti-angle-up"></i>
        </button>-->
    </div>
</div>
<!--</footer>-->
<!-- /footer -->

      </footer></div>

  


  

  </body></html>

